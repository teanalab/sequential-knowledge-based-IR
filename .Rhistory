threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[5], yend1=th[8], x1=th2[4], y1=th[8], color1="red",  linetype1="dotted"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1, fill="red"))
p <- ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1, fill="red"))
geom_text(aes(label=p), vjust=-0.5, size=5)
p
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1, fill="red"))
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1, fill="red"))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1, fill="red"))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1, fill="red", color=color1))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))
threshold1
p <- ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1, fill="", color=color1))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))
p
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill="", color=color1, show.legend=F))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill="a", color=color1, show.legend=F))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill="a", color=color1, show.legend=F))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=color1, show.legend=F))+
geom_text(aes(label=p), vjust=-0.5, size=5)
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=color1, show.legend=F))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds, show.legend=F))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds, show.legend=F))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds, show.legend=F))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds), color = "black")
p <- ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds, show.legend=F))+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
color=Thresholds))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))
p
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
color=Thresholds))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))
data
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
color=Thresholds))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
color=Thresholds))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))+
scale_fill_manual(name = "Concept Layers",
labels = c("Layer 1", "Layer 2", "Layer 3",
"Layer 4"),
values = c("black", "dimgray", "gray",
"white"))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
color=Thresholds))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))+
scale_fill_manual(name = "Concept Layers",
labels = c("Layer 1", "Layer 2", "Layer 3",
"Layer 4"),
values = c("black", "dimgray", "gray",
"white"))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))+
scale_x_continuous(breaks = seq(1,N), labels = seq(1,N))+
xlab("concepts")+
ylab(expression(Q[s](c)))+
scale_y_continuous(limits=c(min(data$y), max(data$y)*1.1),oob = scales::rescale_none)
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
color=Thresholds))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
color=Thresholds, linetype=Thresholds))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))+
scale_fill_manual(name = "Concept Layers",
labels = c("Layer 1", "Layer 2", "Layer 3",
"Layer 4"),
values = c("black", "dimgray", "gray",
"white"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
color=Thresholds, linetype=Thresholds))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds,
linetype=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds,
color=Thresholds))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))+
scale_fill_manual(name = "Concept Layers",
labels = c("Layer 1", "Layer 2", "Layer 3",
"Layer 4"),
values = c("black", "dimgray", "gray",
"white"))
ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds,
linetype=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds,
color=Thresholds))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))+
scale_fill_manual(name = "Concept Layers",
labels = c("Layer 1", "Layer 2", "Layer 3",
"Layer 4"),
values = c("black", "dimgray", "gray",
"white"))+
scale_x_continuous(breaks = seq(1,N), labels = seq(1,N))+
xlab("concepts")+
ylab(expression(Q[s](c)))+
scale_y_continuous(limits=c(min(data$y), max(data$y)*1.1),oob = scales::rescale_none)
p <- ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds,
linetype=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds,
color=Thresholds))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))+
scale_fill_manual(name = "Concept Layers",
labels = c("Layer 1", "Layer 2", "Layer 3",
"Layer 4"),
values = c("black", "dimgray", "gray",
"white"))+
scale_x_continuous(breaks = seq(1,N), labels = seq(1,N))+
xlab("concepts")+
ylab(expression(Q[s](c)))+
scale_y_continuous(limits=c(min(data$y), max(data$y)*1.1),oob = scales::rescale_none)
print(p)
ggsave("SNOPC.pdf", width = 7.26, height = 2.24, units = "cm")
ggsave("SNOPC.pdf")
th = c(0.26,0.23,0.245,0.23,0.22,0.215,0.214,0.212)
thr = c(2.5,4.5,7.5,9.5,11.5,12.5,13.5,13.5+0.1)
th2 = c(0.5,6.5,10.5,13.5-0.1,15.5)
data$col = rep("black", N)
data$fill = data$l
cuts1 <- data.frame(Thresholds="Layer Thresholds", vals=th2[2:length(th2)])
cuts2 <- data.frame(Thresholds="Upper Thresholds", vals=c(th[1], th[3], th[5], th[7]))
cuts3 <- data.frame(Thresholds="Lower Thresholds", vals=c(th[2], th[4], th[6], th[8]))
cuts <- rbind(cuts2,cuts3)
threshold1 <-                   data.frame(Thresholds="Upper Thresholds", xend1=th2[2], yend1=th[1], x1=th2[1], y1=th[1], color1="blue", linetype1="dash")
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[2], yend1=th[2], x1=th2[1], y1=th[2], color1="red",  linetype1="dotted"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Upper Thresholds", xend1=th2[3], yend1=th[3], x1=th2[2], y1=th[3], color1="blue", linetype1="dash"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[3], yend1=th[4], x1=th2[2], y1=th[4], color1="red",  linetype1="dotted"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Upper Thresholds", xend1=th2[4], yend1=th[5], x1=th2[3], y1=th[5], color1="blue", linetype1="dash"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[4], yend1=th[6], x1=th2[3], y1=th[6], color1="red",  linetype1="dotted"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Upper Thresholds", xend1=th2[5], yend1=th[7], x1=th2[4], y1=th[7], color1="blue", linetype1="dash"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[5], yend1=th[8], x1=th2[4], y1=th[8], color1="red",  linetype1="dotted"))
p <- ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds,
linetype=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds,
color=Thresholds))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))+
scale_fill_manual(name = "Concept Layers",
labels = c("Layer 1", "Layer 2", "Layer 3",
"Layer 4"),
values = c("black", "dimgray", "gray",
"white"))+
scale_x_continuous(breaks = seq(1,N), labels = seq(1,N))+
xlab("concepts")+
ylab(expression(Q[s](c)))+
scale_y_continuous(limits=c(min(data$y), max(data$y)*1.1),oob = scales::rescale_none)
print(p)
th = c(0.26,0.23,0.245,0.23,0.22,0.215,0.218,0.214)
thr = c(2.5,4.5,7.5,9.5,11.5,12.5,13.5,13.5+0.1)
th2 = c(0.5,6.5,10.5,13.5-0.1,15.5)
data$col = rep("black", N)
data$fill = data$l
cuts1 <- data.frame(Thresholds="Layer Thresholds", vals=th2[2:length(th2)])
cuts2 <- data.frame(Thresholds="Upper Thresholds", vals=c(th[1], th[3], th[5], th[7]))
cuts3 <- data.frame(Thresholds="Lower Thresholds", vals=c(th[2], th[4], th[6], th[8]))
cuts <- rbind(cuts2,cuts3)
threshold1 <-                   data.frame(Thresholds="Upper Thresholds", xend1=th2[2], yend1=th[1], x1=th2[1], y1=th[1], color1="blue", linetype1="dash")
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[2], yend1=th[2], x1=th2[1], y1=th[2], color1="red",  linetype1="dotted"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Upper Thresholds", xend1=th2[3], yend1=th[3], x1=th2[2], y1=th[3], color1="blue", linetype1="dash"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[3], yend1=th[4], x1=th2[2], y1=th[4], color1="red",  linetype1="dotted"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Upper Thresholds", xend1=th2[4], yend1=th[5], x1=th2[3], y1=th[5], color1="blue", linetype1="dash"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[4], yend1=th[6], x1=th2[3], y1=th[6], color1="red",  linetype1="dotted"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Upper Thresholds", xend1=th2[5], yend1=th[7], x1=th2[4], y1=th[7], color1="blue", linetype1="dash"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[5], yend1=th[8], x1=th2[4], y1=th[8], color1="red",  linetype1="dotted"))
p <- ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds,
linetype=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds,
color=Thresholds))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))+
scale_fill_manual(name = "Concept Layers",
labels = c("Layer 1", "Layer 2", "Layer 3",
"Layer 4"),
values = c("black", "dimgray", "gray",
"white"))+
scale_x_continuous(breaks = seq(1,N), labels = seq(1,N))+
xlab("concepts")+
ylab(expression(Q[s](c)))+
scale_y_continuous(limits=c(min(data$y), max(data$y)*1.1),oob = scales::rescale_none)
print(p)
ggsave("SNOPC.pdf")
ggsave("SNOPC.pdf")
th = c(0.26,0.23,0.245,0.23,0.22,0.216,0.218,0.214)
thr = c(2.5,4.5,7.5,9.5,11.5,12.5,13.5,13.5+0.1)
th2 = c(0.5,6.5,10.5,13.5-0.1,15.5)
data$col = rep("black", N)
data$fill = data$l
cuts1 <- data.frame(Thresholds="Layer Thresholds", vals=th2[2:length(th2)])
cuts2 <- data.frame(Thresholds="Upper Thresholds", vals=c(th[1], th[3], th[5], th[7]))
cuts3 <- data.frame(Thresholds="Lower Thresholds", vals=c(th[2], th[4], th[6], th[8]))
cuts <- rbind(cuts2,cuts3)
threshold1 <-                   data.frame(Thresholds="Upper Thresholds", xend1=th2[2], yend1=th[1], x1=th2[1], y1=th[1], color1="blue", linetype1="dash")
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[2], yend1=th[2], x1=th2[1], y1=th[2], color1="red",  linetype1="dotted"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Upper Thresholds", xend1=th2[3], yend1=th[3], x1=th2[2], y1=th[3], color1="blue", linetype1="dash"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[3], yend1=th[4], x1=th2[2], y1=th[4], color1="red",  linetype1="dotted"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Upper Thresholds", xend1=th2[4], yend1=th[5], x1=th2[3], y1=th[5], color1="blue", linetype1="dash"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[4], yend1=th[6], x1=th2[3], y1=th[6], color1="red",  linetype1="dotted"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Upper Thresholds", xend1=th2[5], yend1=th[7], x1=th2[4], y1=th[7], color1="blue", linetype1="dash"))
threshold1 <- rbind(threshold1, data.frame(Thresholds="Lower Thresholds", xend1=th2[5], yend1=th[8], x1=th2[4], y1=th[8], color1="red",  linetype1="dotted"))
p <- ggplot(data, aes(x, y, fill=factor(fill), width=.7))+
geom_bar(color="black", stat="identity")+
geom_segment(data = threshold1, aes(xend=xend1, yend=yend1, x=x1, y=y1,
fill=NA, color=Thresholds,
linetype=Thresholds), show.legend=F)+
geom_text(aes(label=p), vjust=-0.5, size=5)+
geom_vline(data=cuts1, aes(xintercept = vals,
linetype=Thresholds,
color=Thresholds))+
scale_linetype_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("solid", "dashed", "dotted"))+
scale_color_manual(name = "Thresholds",
labels = c("Layer Thresholds", "Upper Thresholds", "Lower Thresholds"),
values = c("black", "blue", "red"))+
scale_fill_manual(name = "Concept Layers",
labels = c("Layer 1", "Layer 2", "Layer 3",
"Layer 4"),
values = c("black", "dimgray", "gray",
"white"))+
scale_x_continuous(breaks = seq(1,N), labels = seq(1,N))+
xlab("concepts")+
ylab(expression(Q[s](c)))+
scale_y_continuous(limits=c(min(data$y), max(data$y)*1.1),oob = scales::rescale_none)
print(p)
ggsave("SNOPC.pdf")
self.shifty = 0, main = "Teasel population model")
source('~/Dropbox/r/project/seq_qu_exp/teasel.r', echo=TRUE)
source('~/Dropbox/r/project/seq_qu_exp/teasel.r', echo=TRUE)
source('~/Dropbox/r/project/seq_qu_exp/teasel.r', echo=TRUE)
library("plotweb")
install.packages("plotweb")
install.packages(plotweb)
install.packages(foodweb)
install.packages("foodweb")
install.packages("foodweb")
source('~/Dropbox/r/project/seq_qu_exp/teasel.r', echo=TRUE)
library("foodweb")
Teasel <-read.csv("teasel.csv")
Teasel
curves <- matrix(nrow = ncol(Teasel), ncol = ncol(Teasel), 0)
curves[3, 1] <- curves[1, 6] <- -0.35
curves[4, 6] <- curves[6, 4] <- curves[5, 6] <- curves[6, 5] <- 0.08
curves[3, 6] <- 0.35
plotmat(Teasel, pos = c(3, 2, 1), curve = curves,
name = colnames(Teasel), lwd = 1, box.lwd = 2,
cex.txt = 0.8, box.cex = 0.8, box.size = 0.08,
arr.length = 0.5, box.type = "circle", box.prop = 1,
shadow.size = 0.01, self.cex = 0.6, my = -0.075, mx = -0.01,
relsize = 0.9, self.shiftx = c(0, 0, 0.125, -0.12, 0.125, 0),
self.shifty = 0, main = "Teasel population model")
?plotmat
??plotmat
plotmath(Teasel, pos = c(3, 2, 1), curve = curves,
name = colnames(Teasel), lwd = 1, box.lwd = 2,
cex.txt = 0.8, box.cex = 0.8, box.size = 0.08,
arr.length = 0.5, box.type = "circle", box.prop = 1,
shadow.size = 0.01, self.cex = 0.6, my = -0.075, mx = -0.01,
relsize = 0.9, self.shiftx = c(0, 0, 0.125, -0.12, 0.125, 0),
self.shifty = 0, main = "Teasel population model")
curves
library("diagram")
library("diagram")
install.packages("diagram")
library("diagram")
plotmat(Teasel, pos = c(3, 2, 1), curve = curves,
name = colnames(Teasel), lwd = 1, box.lwd = 2,
cex.txt = 0.8, box.cex = 0.8, box.size = 0.08,
arr.length = 0.5, box.type = "circle", box.prop = 1,
shadow.size = 0.01, self.cex = 0.6, my = -0.075, mx = -0.01,
relsize = 0.9, self.shiftx = c(0, 0, 0.125, -0.12, 0.125, 0),
self.shifty = 0, main = "Teasel population model")
library("diagram")
Teasel <-read.csv("teasel.csv")
curves <- matrix(nrow = ncol(Teasel), ncol = ncol(Teasel), 0)
curves[3, 1] <- curves[1, 6] <- -0.35
curves[4, 6] <- curves[6, 4] <- curves[5, 6] <- curves[6, 5] <- 0.08
curves[3, 6] <- 0.35
plotmat(Teasel, pos = c(3, 2, 1), curve = curves,
name = colnames(Teasel), lwd = 1, box.lwd = 2,
cex.txt = 0.8, box.cex = 0.8, box.size = 0.08,
arr.length = 0.5, box.type = "circle", box.prop = 1,
shadow.size = 0.01, self.cex = 0.6, my = -0.075, mx = -0.01,
relsize = 0.9, self.shiftx = c(0, 0, 0.125, -0.12, 0.125, 0),
self.shifty = 0, main = "Teasel population model")
library("diagram")
Teasel <-read.csv("teasel.csv")
curves <- matrix(nrow = ncol(Teasel), ncol = ncol(Teasel), 0)
curves[3, 1] <- curves[1, 6] <- -0.35
curves[4, 6] <- curves[6, 4] <- curves[5, 6] <- curves[6, 5] <- 0.08
curves[3, 6] <- 0.35
plotmat(Teasel, pos = c(3, 2, 1), curve = curves,
name = colnames(Teasel), lwd = 1, box.lwd = 2,
cex.txt = 0.8, box.cex = 0.8, box.size = 0.08,
arr.length = 0.5, box.type = "circle", box.prop = 1,
shadow.size = 0.01, self.cex = 0.6, my = -0.075, mx = -0.01,
relsize = 0.9, self.shiftx = c(0, 0, 0.125, -0.12, 0.125, 0),
self.shifty = 0, main = "Teasel population model")
library("diagram")
# Teasel <-read.csv("teasel.csv")
curves <- matrix(nrow = ncol(Teasel), ncol = ncol(Teasel), 0)
curves[3, 1] <- curves[1, 6] <- -0.35
curves[4, 6] <- curves[6, 4] <- curves[5, 6] <- curves[6, 5] <- 0.08
curves[3, 6] <- 0.35
plotmat(Teasel, pos = c(3, 2, 1), curve = curves,
name = colnames(Teasel), lwd = 1, box.lwd = 2,
cex.txt = 0.8, box.cex = 0.8, box.size = 0.08,
arr.length = 0.5, box.type = "circle", box.prop = 1,
shadow.size = 0.01, self.cex = 0.6, my = -0.075, mx = -0.01,
relsize = 0.9, self.shiftx = c(0, 0, 0.125, -0.12, 0.125, 0),
self.shifty = 0, main = "Teasel population model")
Teasel
